# Utility Functions Best Practices

## ğŸ¯ Utility Function Design Principles

### MUST DO:

- **ALWAYS** create single-purpose utility functions
- **ALWAYS** use proper TypeScript generics for reusability
- **ALWAYS** handle errors gracefully with try-catch blocks
- **ALWAYS** provide JSDoc comments for complex functions
- **ALWAYS** export functions from `src/utils/index.ts`

### NEVER DO:

- âŒ Create utility functions directly in component files
- âŒ Duplicate utility functions across different files
- âŒ Use `any` type in utility functions
- âŒ Ignore error handling in utility functions

## ğŸ“… Date Utilities (`src/utils/date.ts`)

### MUST DO:

```typescript
/**
 * ë‚ ì§œë¥¼ ìƒëŒ€ì  ì‹œê°„ìœ¼ë¡œ ë³€í™˜ (ì˜ˆ: "3ë¶„ ì „", "1ì‹œê°„ ì „")
 * @param date - ë³€í™˜í•  ë‚ ì§œ
 * @returns ìƒëŒ€ì  ì‹œê°„ ë¬¸ìì—´
 */
export const formatRelativeTime = (date: string | Date): string => {
  const now = new Date();
  const targetDate = new Date(date);
  const diffInSeconds = Math.floor((now.getTime() - targetDate.getTime()) / 1000);

  if (diffInSeconds < 60) return 'ë°©ê¸ˆ ì „';

  const diffInMinutes = Math.floor(diffInSeconds / 60);
  if (diffInMinutes < 60) return `${diffInMinutes}ë¶„ ì „`;

  const diffInHours = Math.floor(diffInMinutes / 60);
  if (diffInHours < 24) return `${diffInHours}ì‹œê°„ ì „`;

  const diffInDays = Math.floor(diffInHours / 24);
  if (diffInDays < 7) return `${diffInDays}ì¼ ì „`;

  const diffInWeeks = Math.floor(diffInDays / 7);
  if (diffInWeeks < 4) return `${diffInWeeks}ì£¼ ì „`;

  const diffInMonths = Math.floor(diffInDays / 30);
  if (diffInMonths < 12) return `${diffInMonths}ê°œì›” ì „`;

  const diffInYears = Math.floor(diffInDays / 365);
  return `${diffInYears}ë…„ ì „`;
};

/**
 * ì´ˆë¥¼ MM:SS í˜•ì‹ìœ¼ë¡œ ë³€í™˜
 * @param seconds - ë³€í™˜í•  ì´ˆ
 * @returns MM:SS í˜•ì‹ì˜ ë¬¸ìì—´
 */
export const formatDuration = (seconds: number): string => {
  const minutes = Math.floor(seconds / 60);
  const remainingSeconds = seconds % 60;
  return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
};
```

### NEVER DO:

```typescript
// âŒ WRONG - Avoid these patterns
export const formatTime = (date: any): any => {
  // Don't use any
  return 'some time ago';
};

export const formatSeconds = (sec: any): string => {
  // Don't use any
  return `${sec}:00`;
};
```

## ğŸ“ String Utilities (`src/utils/string.ts`)

### MUST DO:

```typescript
/**
 * í…ìŠ¤íŠ¸ë¥¼ ì§€ì •ëœ ê¸¸ì´ë¡œ ìë¥´ê³  ë§ì¤„ì„í‘œ ì¶”ê°€
 * @param text - ìë¥¼ í…ìŠ¤íŠ¸
 * @param maxLength - ìµœëŒ€ ê¸¸ì´
 * @returns ì˜ë¦° í…ìŠ¤íŠ¸
 */
export const truncateText = (text: string, maxLength: number): string => {
  if (text.length <= maxLength) return text;
  return text.slice(0, maxLength) + '...';
};

/**
 * í…ìŠ¤íŠ¸ë¥¼ ì¹´ë©œì¼€ì´ìŠ¤ë¡œ ë³€í™˜
 * @param str - ë³€í™˜í•  ë¬¸ìì—´
 * @returns ì¹´ë©œì¼€ì´ìŠ¤ ë¬¸ìì—´
 */
export const toCamelCase = (str: string): string => {
  return str
    .replace(/(?:^\w|[A-Z]|\b\w)/g, (word, index) => {
      return index === 0 ? word.toLowerCase() : word.toUpperCase();
    })
    .replace(/\s+/g, '');
};

/**
 * í…ìŠ¤íŠ¸ê°€ ì´ë©”ì¼ í˜•ì‹ì¸ì§€ í™•ì¸
 * @param email - í™•ì¸í•  ì´ë©”ì¼
 * @returns ì´ë©”ì¼ í˜•ì‹ ì—¬ë¶€
 */
export const isValidEmail = (email: string): boolean => {
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  return emailRegex.test(email);
};
```

### NEVER DO:

```typescript
// âŒ WRONG - Avoid these patterns
export const truncate = (text: any, length: any): any => {
  // Don't use any
  return text.substring(0, length);
};

export const checkEmail = (email: any): any => {
  // Don't use any
  return email.includes('@');
};
```

## âœ… Validation Utilities (`src/utils/validation.ts`)

### MUST DO:

```typescript
/**
 * íŒ¨ìŠ¤ì›Œë“œ ê°•ë„ ê²€ì‚¬
 * @param password - ê²€ì‚¬í•  íŒ¨ìŠ¤ì›Œë“œ
 * @returns ê²€ì‚¬ ê²°ê³¼ì™€ ì˜¤ë¥˜ ë©”ì‹œì§€
 */
export const validatePassword = (
  password: string,
): {
  isValid: boolean;
  errors: string[];
} => {
  const errors: string[] = [];

  if (password.length < 8) {
    errors.push('ë¹„ë°€ë²ˆí˜¸ëŠ” ìµœì†Œ 8ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
  }

  if (!/[A-Z]/.test(password)) {
    errors.push('ë¹„ë°€ë²ˆí˜¸ëŠ” ëŒ€ë¬¸ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.');
  }

  if (!/[a-z]/.test(password)) {
    errors.push('ë¹„ë°€ë²ˆí˜¸ëŠ” ì†Œë¬¸ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.');
  }

  if (!/\d/.test(password)) {
    errors.push('ë¹„ë°€ë²ˆí˜¸ëŠ” ìˆ«ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.');
  }

  if (!/[!@#$%^&*(),.?":{}|<>]/.test(password)) {
    errors.push('ë¹„ë°€ë²ˆí˜¸ëŠ” íŠ¹ìˆ˜ë¬¸ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.');
  }

  return {
    isValid: errors.length === 0,
    errors,
  };
};

/**
 * ì‚¬ìš©ìëª… ìœ íš¨ì„± ê²€ì‚¬
 * @param username - ê²€ì‚¬í•  ì‚¬ìš©ìëª…
 * @returns ê²€ì‚¬ ê²°ê³¼ì™€ ì˜¤ë¥˜ ë©”ì‹œì§€
 */
export const validateUsername = (
  username: string,
): {
  isValid: boolean;
  errors: string[];
} => {
  const errors: string[] = [];

  if (username.length < 3) {
    errors.push('ì‚¬ìš©ìëª…ì€ ìµœì†Œ 3ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
  }

  if (username.length > 20) {
    errors.push('ì‚¬ìš©ìëª…ì€ ìµœëŒ€ 20ìê¹Œì§€ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
  }

  if (!/^[a-zA-Z0-9ê°€-í£_]+$/.test(username)) {
    errors.push('ì‚¬ìš©ìëª…ì€ ì˜ë¬¸, ìˆ«ì, í•œê¸€, ì–¸ë”ìŠ¤ì½”ì–´ë§Œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.');
  }

  return {
    isValid: errors.length === 0,
    errors,
  };
};
```

### NEVER DO:

```typescript
// âŒ WRONG - Avoid these patterns
export const checkPassword = (pass: any): any => {
  // Don't use any
  return pass.length > 5;
};

export const validateUser = (user: any): any => {
  // Don't use any
  return user && user.length > 2;
};
```

## ğŸ’¾ Storage Utilities (`src/utils/storage.ts`)

### MUST DO:

```typescript
/**
 * ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ë°ì´í„° ì €ì¥
 * @param key - ì €ì¥í•  í‚¤
 * @param value - ì €ì¥í•  ê°’
 */
export const setStorageItem = <T>(key: string, value: T): void => {
  try {
    const serializedValue = JSON.stringify(value);
    localStorage.setItem(key, serializedValue);
  } catch (error) {
    console.error('ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì €ì¥ ì‹¤íŒ¨:', error);
  }
};

/**
 * ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
 * @param key - ê°€ì ¸ì˜¬ í‚¤
 * @param defaultValue - ê¸°ë³¸ê°’
 * @returns ì €ì¥ëœ ê°’ ë˜ëŠ” ê¸°ë³¸ê°’
 */
export const getStorageItem = <T>(key: string, defaultValue?: T): T | null => {
  try {
    const item = localStorage.getItem(key);
    if (item === null) {
      return defaultValue || null;
    }
    return JSON.parse(item);
  } catch (error) {
    console.error('ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì½ê¸° ì‹¤íŒ¨:', error);
    return defaultValue || null;
  }
};

/**
 * í† í° ê´€ë ¨ í¸ì˜ í•¨ìˆ˜ë“¤
 */
export const setAccessToken = (token: string): void => {
  setStorageItem('accessToken', token);
};

export const getAccessToken = (): string | null => {
  return getStorageItem<string>('accessToken');
};

export const removeTokens = (): void => {
  localStorage.removeItem('accessToken');
  localStorage.removeItem('refreshToken');
};
```

### NEVER DO:

```typescript
// âŒ WRONG - Avoid these patterns
export const saveToStorage = (key: string, value: any): void => {
  // Don't use any
  localStorage.setItem(key, JSON.stringify(value));
};

export const getFromStorage = (key: string): any => {
  // Don't use any
  return JSON.parse(localStorage.getItem(key));
};
```

## ğŸ”„ Common Utilities (`src/utils/index.ts`)

### MUST DO:

```typescript
// ë‚ ì§œ ê´€ë ¨ ìœ í‹¸ë¦¬í‹°
export * from './date';

// ë¬¸ìì—´ ê´€ë ¨ ìœ í‹¸ë¦¬í‹°
export * from './string';

// ìœ íš¨ì„± ê²€ì‚¬ ê´€ë ¨ ìœ í‹¸ë¦¬í‹°
export * from './validation';

// ìŠ¤í† ë¦¬ì§€ ê´€ë ¨ ìœ í‹¸ë¦¬í‹°
export * from './storage';

// ê³µí†µ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
export const debounce = <T extends (...args: any[]) => any>(
  func: T,
  wait: number,
): ((...args: Parameters<T>) => void) => {
  let timeout: NodeJS.Timeout;
  return (...args: Parameters<T>) => {
    clearTimeout(timeout);
    timeout = setTimeout(() => func(...args), wait);
  };
};

export const throttle = <T extends (...args: any[]) => any>(
  func: T,
  limit: number,
): ((...args: Parameters<T>) => void) => {
  let inThrottle: boolean;
  return (...args: Parameters<T>) => {
    if (!inThrottle) {
      func(...args);
      inThrottle = true;
      setTimeout(() => (inThrottle = false), limit);
    }
  };
};

export const generateId = (): string => {
  return Math.random().toString(36).substr(2, 9);
};
```

## ğŸš¨ Critical Utility Rules

### IMMEDIATE ACTIONS REQUIRED:

1. **NEVER** create utility functions in component files
2. **ALWAYS** use proper TypeScript generics for reusability
3. **ALWAYS** handle errors gracefully with try-catch blocks
4. **ALWAYS** provide JSDoc comments for complex functions
5. **NEVER** use `any` type in utility functions

### ENFORCEMENT:

- All utility functions MUST be placed in appropriate utils folders
- All utility functions MUST have proper TypeScript types
- All utility functions MUST include error handling
- All utility functions MUST be exported from `src/utils/index.ts`
- All complex utility functions MUST have JSDoc comments
  description:
  globs:
  alwaysApply: false

---

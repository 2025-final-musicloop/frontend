# React 프로젝트 구조 개선 학습 자료

## 📋 개요

이 문서는 React + TypeScript 프로젝트의 구조를 개선하는 과정을 학습 자료로 정리한 것입니다. 실제 음악 관련 웹 애플리케이션 프로젝트를 대상으로 진행된 개선 작업의 모든 과정과 이유를 상세히 설명합니다.

## 🎯 개선 목표

### 기존 문제점

1. **컴포넌트 구조가 평면적** - 모든 컴포넌트가 `src/components/`에 무작위로 배치
2. **타입 시스템 부족** - API 응답 타입, 컴포넌트 Props 타입 정의 부족
3. **유틸리티 함수 부족** - 재사용 가능한 유틸리티 함수들이 없음
4. **확장성 문제** - 프로젝트가 커질수록 관리가 어려워짐

### 개선 목표

1. **체계적인 폴더 구조** - 역할별 컴포넌트 분리
2. **강화된 타입 시스템** - TypeScript 타입 정의 체계화
3. **유틸리티 함수 추가** - 재사용 가능한 함수들 모듈화
4. **확장 가능한 구조** - 미래 확장을 고려한 설계

## 🏗️ 1단계: 컴포넌트 재구성

### 1.1 폴더 구조 설계

```
src/components/
├── ui/           # 재사용 가능한 UI 컴포넌트
├── layout/       # 레이아웃 관련 컴포넌트
├── music/        # 음악 관련 컴포넌트
└── common/       # 공통 섹션 컴포넌트
```

### 1.2 컴포넌트 분류 기준

| 폴더      | 기준                          | 예시 컴포넌트                              |
| --------- | ----------------------------- | ------------------------------------------ |
| `ui/`     | 재사용 가능한 기본 UI 요소    | Button, BackButton                         |
| `layout/` | 페이지 레이아웃 구성 요소     | Header, Sidebar, SidebarItem               |
| `music/`  | 도메인 특화 컴포넌트          | MusicCard                                  |
| `common/` | 여러 페이지에서 사용되는 섹션 | HeroSection, BlobBackground, ExploreHeader |

### 1.3 실제 이동 작업

```bash
# UI 컴포넌트 이동
move src\components\Button.* src\components\ui\
move src\components\BackButton.* src\components\ui\

# 레이아웃 컴포넌트 이동
move src\components\Header.* src\components\layout\
move src\components\Sidebar.* src\components\layout\
move src\components\SidebarItem.* src\components\layout\

# 도메인 특화 컴포넌트 이동
move src\components\MusicCard.* src\components\music\

# 공통 섹션 컴포넌트 이동
move src\components\HeroSection.* src\components\common\
move src\components\BlobBackground.* src\components\common\
move src\components\ExploreHeader.* src\components\common\
```

### 1.4 Import 경로 수정

**수정 전:**

```typescript
import Button from '../../components/Button';
import Header from '../../components/Header';
```

**수정 후:**

```typescript
import Button from '../../components/ui/Button';
import Header from '../../components/layout/Header';
```

## 🔧 2단계: 타입 시스템 강화

### 2.1 타입 파일 구조

```
src/types/
├── api.ts        # API 응답 타입들
├── components.ts  # 컴포넌트 Props 타입들
└── index.ts      # 모든 타입 export
```

### 2.2 API 타입 정의 (`src/types/api.ts`)

```typescript
// 사용자 관련 타입
export interface User {
  id: number;
  username: string;
  email?: string;
  created_at?: string;
  updated_at?: string;
}

// 인증 관련 타입
export interface LoginRequest {
  username: string;
  password: string;
}

export interface AuthResponse {
  access: string;
  refresh: string;
  user: User;
}

// 음악 관련 타입
export interface Music {
  id: number;
  title: string;
  artist: string;
  album?: string;
  duration?: number;
  file_url?: string;
  cover_image?: string;
  created_at: string;
  updated_at: string;
}

// 게시글 관련 타입
export interface Post {
  id: number;
  title: string;
  content: string;
  author: User;
  created_at: string;
  updated_at: string;
  likes_count?: number;
  comments_count?: number;
}
```

### 2.3 컴포넌트 Props 타입 정의 (`src/types/components.ts`)

```typescript
// UI 컴포넌트 Props
export interface ButtonProps {
  children: ReactNode;
  onClick?: () => void;
  variant?: 'primary' | 'secondary' | 'outline' | 'ghost';
  size?: 'sm' | 'md' | 'lg';
  disabled?: boolean;
  className?: string;
  type?: 'button' | 'submit' | 'reset';
}

// 레이아웃 컴포넌트 Props
export interface HeaderProps {
  title?: string;
  showBackButton?: boolean;
  onBackClick?: () => void;
  onLogin?: () => void;
  children?: ReactNode;
}

// 도메인 특화 컴포넌트 Props
export interface MusicCardProps {
  id: number;
  title: string;
  artist: string;
  music?: Music;
  onPlay?: (music: Music) => void;
  onPause?: (music: Music) => void;
  onLike?: (music: Music) => void;
  isPlaying?: boolean;
  isLiked?: boolean;
  className?: string;
}
```

### 2.4 타입 적용 예시

**수정 전:**

```typescript
const Button: React.FC = ({ variant, size, onClick, children }) => {
  // 타입 안전성 없음
};
```

**수정 후:**

```typescript
const Button: React.FC<ButtonProps> = ({ variant = 'primary', size = 'md', onClick, children }) => {
  // 타입 안전성 보장
};
```

## 🛠️ 3단계: 유틸리티 함수 추가

### 3.1 유틸리티 파일 구조

```
src/utils/
├── date.ts       # 날짜 관련 유틸리티
├── string.ts     # 문자열 관련 유틸리티
├── validation.ts # 유효성 검사 유틸리티
├── storage.ts    # 로컬 스토리지 유틸리티
└── index.ts      # 모든 유틸리티 export
```

### 3.2 날짜 유틸리티 (`src/utils/date.ts`)

```typescript
/**
 * 날짜를 상대적 시간으로 변환 (예: "3분 전", "1시간 전")
 */
export const formatRelativeTime = (date: string | Date): string => {
  const now = new Date();
  const targetDate = new Date(date);
  const diffInSeconds = Math.floor((now.getTime() - targetDate.getTime()) / 1000);

  if (diffInSeconds < 60) return '방금 전';

  const diffInMinutes = Math.floor(diffInSeconds / 60);
  if (diffInMinutes < 60) return `${diffInMinutes}분 전`;

  // ... 더 많은 로직
};

/**
 * 초를 MM:SS 형식으로 변환
 */
export const formatDuration = (seconds: number): string => {
  const minutes = Math.floor(seconds / 60);
  const remainingSeconds = seconds % 60;
  return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
};
```

### 3.3 문자열 유틸리티 (`src/utils/string.ts`)

```typescript
/**
 * 텍스트를 지정된 길이로 자르고 말줄임표 추가
 */
export const truncateText = (text: string, maxLength: number): string => {
  if (text.length <= maxLength) return text;
  return text.slice(0, maxLength) + '...';
};

/**
 * 텍스트를 카멜케이스로 변환
 */
export const toCamelCase = (str: string): string => {
  return str
    .replace(/(?:^\w|[A-Z]|\b\w)/g, (word, index) => {
      return index === 0 ? word.toLowerCase() : word.toUpperCase();
    })
    .replace(/\s+/g, '');
};
```

### 3.4 유효성 검사 유틸리티 (`src/utils/validation.ts`)

```typescript
/**
 * 패스워드 강도 검사
 */
export const validatePassword = (
  password: string,
): {
  isValid: boolean;
  errors: string[];
} => {
  const errors: string[] = [];

  if (password.length < 8) {
    errors.push('비밀번호는 최소 8자 이상이어야 합니다.');
  }

  if (!/[A-Z]/.test(password)) {
    errors.push('비밀번호는 대문자를 포함해야 합니다.');
  }

  // ... 더 많은 검증 로직

  return {
    isValid: errors.length === 0,
    errors,
  };
};

/**
 * 이메일 유효성 검사
 */
export const validateEmail = (
  email: string,
): {
  isValid: boolean;
  errors: string[];
} => {
  const errors: string[] = [];
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

  if (!emailRegex.test(email)) {
    errors.push('올바른 이메일 형식이 아닙니다.');
  }

  return {
    isValid: errors.length === 0,
    errors,
  };
};
```

### 3.5 스토리지 유틸리티 (`src/utils/storage.ts`)

```typescript
/**
 * 로컬 스토리지에 데이터 저장
 */
export const setStorageItem = <T>(key: string, value: T): void => {
  try {
    const serializedValue = JSON.stringify(value);
    localStorage.setItem(key, serializedValue);
  } catch (error) {
    console.error('로컬 스토리지 저장 실패:', error);
  }
};

/**
 * 로컬 스토리지에서 데이터 가져오기
 */
export const getStorageItem = <T>(key: string, defaultValue?: T): T | null => {
  try {
    const item = localStorage.getItem(key);
    if (item === null) {
      return defaultValue || null;
    }
    return JSON.parse(item);
  } catch (error) {
    console.error('로컬 스토리지 읽기 실패:', error);
    return defaultValue || null;
  }
};

// 토큰 관련 편의 함수들
export const setAccessToken = (token: string): void => {
  setStorageItem('accessToken', token);
};

export const getAccessToken = (): string | null => {
  return getStorageItem<string>('accessToken');
};
```

## 🔄 4단계: Import 경로 수정

### 4.1 수정이 필요한 파일들

모든 컴포넌트 import 경로를 새로운 폴더 구조에 맞게 수정:

```typescript
// 수정 전
import Button from '../../components/Button';
import Header from '../../components/Header';
import Sidebar from '../../components/Sidebar';

// 수정 후
import Button from '../../components/ui/Button';
import Header from '../../components/layout/Header';
import Sidebar from '../../components/layout/Sidebar';
```

### 4.2 타입 import 경로 수정

```typescript
// 수정 전
import type { ButtonProps } from '../types';

// 수정 후
import type { ButtonProps } from '../../types';
```

## 📊 개선 결과

### Before (개선 전)

```
src/components/
├── Button.tsx
├── BackButton.tsx
├── Header.tsx
├── Sidebar.tsx
├── SidebarItem.tsx
├── MusicCard.tsx
├── HeroSection.tsx
├── BlobBackground.tsx
└── ExploreHeader.tsx
```

### After (개선 후)

```
src/components/
├── ui/
│   ├── Button.tsx
│   └── BackButton.tsx
├── layout/
│   ├── Header.tsx
│   ├── Sidebar.tsx
│   └── SidebarItem.tsx
├── music/
│   └── MusicCard.tsx
└── common/
    ├── HeroSection.tsx
    ├── BlobBackground.tsx
    └── ExploreHeader.tsx

src/types/
├── api.ts
├── components.ts
└── index.ts

src/utils/
├── date.ts
├── string.ts
├── validation.ts
├── storage.ts
└── index.ts
```

## 🎯 개선 효과

### 1. **가독성 향상**

- 컴포넌트의 역할이 폴더명으로 명확히 구분됨
- 새로운 개발자가 프로젝트 구조를 쉽게 이해할 수 있음

### 2. **유지보수성 향상**

- 관련 컴포넌트들이 함께 그룹화되어 수정이 용이
- 타입 안전성으로 런타임 오류 감소

### 3. **확장성 향상**

- 새로운 컴포넌트 추가 시 적절한 폴더에 배치 가능
- 유틸리티 함수 재사용으로 중복 코드 감소

### 4. **개발 효율성 향상**

- IDE의 자동완성 기능 향상
- 타입 체크로 개발 시 오류 조기 발견

## 💡 학습 포인트

### 1. **폴더 구조 설계 원칙**

- **단일 책임 원칙**: 각 폴더는 명확한 역할을 가져야 함
- **확장성 고려**: 미래의 컴포넌트 추가를 고려한 구조
- **일관성**: 팀 전체가 이해할 수 있는 명명 규칙

### 2. **타입 시스템 설계**

- **API 타입**: 백엔드와의 통신 타입 정의
- **컴포넌트 Props**: 재사용 가능한 인터페이스 설계
- **유니온 타입**: 다양한 옵션을 타입으로 표현

### 3. **유틸리티 함수 설계**

- **단일 기능**: 각 함수는 하나의 명확한 기능만 수행
- **재사용성**: 여러 곳에서 사용할 수 있도록 설계
- **타입 안전성**: TypeScript의 제네릭 활용

### 4. **점진적 개선**

- **단계별 접근**: 한 번에 모든 것을 바꾸지 않고 단계별로 진행
- **호환성 유지**: 기존 코드와의 호환성을 고려
- **테스트**: 각 단계마다 정상 작동 확인

## 🚀 다음 단계 제안

1. **테스트 코드 추가**: Jest + React Testing Library로 컴포넌트 테스트
2. **환경 설정 개선**: 환경변수 관리 및 빌드 설정 최적화
3. **성능 최적화**: React.memo, useMemo, useCallback 활용
4. **접근성 개선**: ARIA 속성 및 키보드 네비게이션 추가

---

_이 학습 자료는 실제 프로젝트 개선 과정을 바탕으로 작성되었으며, React + TypeScript 프로젝트의 구조 개선에 대한 실무적인 가이드라인을 제공합니다._
